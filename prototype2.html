<!DOCTYPE html>
<html>
<head>
  <title>page test</title>
  <link href="css/page-basic.css" rel="stylesheet">
  <style>
    .search {
        display:block;
        color: white;
        background-color: blue;
        text-transform: uppercase;
        font-family: sans-serif;
        padding: 0.5em;
        text-align: center;
    }
    .search a {
        text-transform: none;
        color: #ccc;
    }

    .search div {
        display: inline-block;
    }

    .search label {
        max-height: 1.24em;
    }

    .hide {
        display:none;
        visibility: hidden;
        width: 0;
    }

    .show {
        display: inline-block;
        visibility: visible;
        width: auto;
    }

    .search select {
        text-transform: uppercase;
        color: white;
        background-color: #ffa500; /* orange */
        border: 0.24em solid #ff8c00; /* dark orange */
        display:inline-block;
        font-size: 0.84em;
    }

    .search input[type=search] {
        position: relative;
        font-size: 1.0em;
        width: 24em;
        display:inline-block;
    }

    .search button {
        position: relative;
        text-transform: uppercase;
        color: white;
        background-color: #ffa500; /* orange */
        border: 0.24em solid #ff8c00; /* dark orange */
        border-radius: 2.24em;
        display:inline-block;
        font-size: 1.0em;
    }

  </style>
</head>
<body>
<header><h1>prototype 2</h1></header>
<section>
    <!--
    SEARCH TARGET | LABEL | DESCRIPTION
    --------------|-------|------------------
    EDS | Find It | Articles, Books, etc.
    --------------|-------|------------------
    TIND | Library Catalog | Books and Print Journals
    --------------|-------|------------------
    SFX | Find eJournals | Library Ejournal subscriptions
    --------------|-------|------------------
    TIND | Course Reserves |
    --------------|-------|------------------
    Google Custom Search | CODA: Caltech Collection of Digital Archives | Caltechâ€™s Institutional Repository
    --------------|-------|------------------
    Google Custom Search | Website search | Library website and LibGuides
    --------------|-------|------------------
    Link to web page | More search tools and Help |
    --------------|-------|------------------
    -->
<form class="search">
<div>
    <label for="resources">Search</label>
    <select name="resources" class="resources">
        <option value="eds">Fint It</option>
        <option value="tind" selected>Library Catalog</option>
        <option value="sfx">Find eJounrals</option>
        <option value="course-reserves">Course Reserves</option>
        <option value="coda">CODA: Caltech Collection of Digital Archives</option>
        <option value="website">Website</option>
    </select>
</div>
<div>
    <span class="books hide">
        <label>By</label>
        <select>
            <option value="keyword">Keyword</option>
            <option value="title">Title</option>
            <option value="author">Author</option>
            <option value="subject">Subject</option>
        </select>
    </span><!-- class="books"-->
    <span class="journals hide">
        <label>By</label>
        <select>
            <option value="title">Journal Title</option>
            <option value="author">Journal Author</option>
            <option value="subject">Journal Subject</option>
        </select>
    </span><!-- class="journals"-->
    <span class="articles hide">
        <label>By</label>
        <select>
            <option value="title">Article Title</option>
            <option value="author">Article Author</option>
            <option value="subject">Article Subject</option>
            <option value="keyword">Article Keyword</option>
        </select>
    </span><!-- class="articles"-->
    <span class="course-reserves hide">
        <label>By</label>
        <select>
            <option value="cousre">Course</option>
            <option value="instructor">Instructor</option>
        </select>
    </span>
</div>
<div><label>For</label>
    <input name="q" type="search" >
    <button>Search</button>
</div>
<p>(<a href="">More search tools and Help</a>)
</form>
  </section>
  <nav>
     <ol>
        <li><a href="index.html">start</a></li>
        <li><a href="prototype1.html">prototype one</a></li>
        <li><a href="prototype2.html">prototype two</a></li>
        <li><a href="prototype3.html">prototype three</a> (not implemented, a test of the EDS form)</li>
    </ol>
  </nav>
  <footer>footer goes here.</footer>
<script>
(function (doc, win) {
    var search = document.querySelector(".search"),
        resources = search.querySelector("select.resources"),
        books = search.querySelector("span.books"),
        journals = search.querySelector("span.journals"),
        articles = search.querySelector("span.articles"),
        reserves = search.querySelector("span.course-reserves"),
        searchInput = search.querySelector("input[type=search]"),
        searchButton = search.querySelector("button");


    resources.tabIndex = 1;
    books.tabIndex = 2;
    journals.tabIndex = 2;
    articles.tabIndex = 2;
    searchInput.tabIndex = 3;
    searchButton.tabIndex = 4;

    function showFilter(selector, addClass, removeClass) {
        var elem = search.querySelector(selector), s = "";

        console.log("DEBUG addClass: "+addClass);
        console.log("DEBUG removeClass: "+removeClass);
        if (elem !== null) {
            console.log("DEBUG showing fix selector: "+selector);
            s = elem.className;
            if (s.indexOf(addClass) == -1) {
                s = s.replace(removeClass, "");
                s = s + " " + addClass;
            }
            elem.className = s.trim();
            console.log("DEBUG show className: "+elem.className)
            elem.focus();
        }
    }

    function refreshFilter(value) {
        console.log("DEBUG selected: "+value);
        switch (value) {
            case "eds":
                showFilter(".books", "hide", "show");
                showFilter(".journals", "hide", "show");
                showFilter(".articles", "hide", "show");
                showFilter(".course-reserves", "hide", "show");
                break;
            case "tind":
                showFilter(".books", "show", "hide");
                showFilter(".journals", "hide", "show");
                showFilter(".articles", "hide", "show");
                showFilter(".course-reserves", "hide", "show");
                break;
            case "sfx":
                showFilter(".books", "hide", "show");
                showFilter(".journals", "show", "hide");
                showFilter(".articles", "hide", "show");
                showFilter(".course-reserves", "hide", "show");
                break;
            case "course-reserves":
                showFilter(".books", "hide", "show");
                showFilter(".journals", "hide", "show");
                showFilter(".articles", "hide", "show");
                showFilter(".course-reserves", "show", "hide");
                break;
            case 'articles':
                showFilter(".books", "hide", "show");
                showFilter(".journals", "hide", "show");
                showFilter(".articles", "show", "hide");
                showFilter(".course-reserves", "hide", "show");
                break;
            case "coda":
                showFilter(".books", "hide", "show");
                showFilter(".journals", "hide", "show");
                showFilter(".articles", "hide", "show");
                showFilter(".course-reserves", "hide", "show");
                break;
            case "website":
                showFilter(".books", "hide", "show");
                showFilter(".journals", "hide", "show");
                showFilter(".articles", "hide", "show");
                showFilter(".course-reserves", "hide", "show");
                break;
            default:
                showFilter(".books", "hide", "show");
                showFilter(".journals", "hide", "show");
                showFilter(".articles", "hide", "show");
                showFilter(".course-reserves", "hide", "show");
                break;
        }
    }

    function filterChange (evt) {
        var select = evt.target,
            value = select.options[select.selectedIndex].value;
        refreshFilter(value);
    }

    resources.addEventListener("change", filterChange, false);
    // Now refresh the form based on default selection.
    refreshFilter(resources.options[resources.selectedIndex].value);
}(document, window))
</script>
</p>
</body>
</html>
